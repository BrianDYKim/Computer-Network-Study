# 웹과 HTTP

## 2.2.1 HTTP 개요

용어를 정리하는 느낌으로 해당 파트를 정리하겠습니다.

HTTP는 **Hyper Text Transfer Protocol** 의 줄임말로, Hyper Text를 전달하는 애플리케이션 계층의 프로토콜을 의미합니다.

HTTP는 TCP 프로토콜을 기본으로 사용하며, HTTP를 사용하는 클라이언트는 우선 상대 호스트와 TCP 연결을 수행합니다. 연결이 수립되면 HTTP 요청 메시지를 소켓 인터페이스를 이용해서 전송하고, 다시 소켓 인터페이스를 통해서 HTTP 응답 메시지를 수신하는 방식으로 동작합니다.

HTTP는 클라이언트를 향해서 메시지가 전달되면 서버는 클라이언트에 대한 상태를 기억하지 않기 때문에 **무상태(Stateless) 기반의 프로토콜** 이라고 불립니다.

## 2.2.2 비지속 연결과 지속 연결

비지속 연결과 지속 연결의 차이점이라면, **TCP 세션 (TCP 커넥션)이 장기적으로 유지되는가, 혹은 데이터 하나만을 주고받는 동안에만 수명을 가지고 있는가** 에 있다고 볼 수 있습니다.

참고로, HTTP 1.0 까지의 경우 데이터를 주고받기 전에 항상 TCP 레이어에서 **3-way handshake** 를 수행하고, 데이터를 주고받으면 즉시 **4-handshake** 과정을 통해 연결을 바로 끊어버립니다.

HTTP 1.1 부터는 지속 연결을 통해서 3-handshake에 의한 오버헤드를 일부 극복하였는데, 다음 파트에서 마저 설명드리겠습니다.

### 지속 연결 HTTP

우선 **RTT(Round-Trip Time)** 이란 용어에 대해서 설명드리도록 하겠습니다.

RTT란, 패킷 하나가 상대 호스트와의 통신을 하는데 걸리는 총 왕복 시간을 의미합니다. HTTP 1.1 부터는 RTT를 기반으로 TCP 연결을 지속할지 말지 여부를 결정하는 방식으로 지속 연결을 구현합니다.

참고로, HTTP 1.1 부터는 HTTP 1.0 과는 다르게 **파이프라이닝(Pipelining)** 을 지원합니다. 파이프라이닝이란, 진행중인 요구에 대한 응답을 대기하지 않고 상대 호스트에 리퀘스트를 계속해서 보낼 수 있는 기능입니다. 하지만, **HTTP 1.1의 파이프라이닝은 멀티플렉싱(Multiplexing)을 지원하지 않고 단지 응답에 대한 처리를 미룰 뿐이며 응답은 순차적으로 처리되기 때문에 HTTP 1.1이 파이프라이닝을 지원하더라도 실제로 파이프라이닝을 구현한 곳은 거의 없습니다.** (지금 굳이 자세하게 알아둘 필요는 없음)

## 2.2.4 Cookie

쿠키는 웹사이트가 사용자를 식별하는데 사용할 수 있습니다.

쿠키는 최초에 사용자가 특정 웹사이트로 접속할 때 서버는 데이터베이스에 특정한 엔티티를 만들어두고 해당 엔티티에 대한 식별자 값을 클라이언트에게 전송합니다.

그리고 해당 사용자가 set-cookie 필드에 해당 식별자 값을 넣어서 요청을 전송하면, 해당 웹사이트는 데이터베이스에 저장된 엔티티를 식별자를 이용해서 가져오는 방식으로 동작합니다.

## 2.2.5 웹 캐싱

웹 캐시는 간단하게 설명하자면, 특정 공급자가 사용자에게 상대적으로 가까운 거리에 서버를 설치하고 서버에 사용자가 받을 데이터의 사본을 보관하는 방식으로, **서버와 사용자 간의 물리적 거리를 좁힘으로써 사용자 경험을 높이는 방법** 입니다.

### 조건부 GET

웹 캐싱의 문제점은, 데이터가 수정되는 경우 프록시 서버(proxy server) 의 데이터가 최신이 아닐 수도 있다는 것입니다.

HTTP는 이러한 상황을 대비하여 **조건부 GET** 이라는 것을 지원하는데, HTTP 헤더가 아래의 두 가지 헤더 라인을 포함하면 조건부 GET 요청이라고 볼 수 있습니다.

1. GET method
2. If-Modified-Since

서버와 클라이언트는 If-Modified-Since 헤더 라인과 Last-Modified 헤더 라인을 이용해서 조건부 GET 통신을 주고받습니다.
